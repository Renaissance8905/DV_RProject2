---
title: "DV_RProject2: Vehicle Recalls"
output: html_document
---

![](./Graphics/Cowboy.jpg) 

## 00. Create/Clone a github repository
Go to SourceTree software. Create new git repository in DataVisualization folder (on same level as DrCannata folder).
![](./Graphics/createrepo.png)

If did not create the repo, clone the repo in SourceTree software.
![](./Graphics/clonerepo.png)

## 01. Create RStudio Project
Create an RStudio project in the project folder.
![](./Graphics/createproject01.png)

## 02. Setup RStudio 
 Create three folders in RStudio Project:  
   **00 Doc**: where .Rmd lives  
   **01 Data**: where data will be stored  
   **02 Visualizations**: where data is explored in ggplot 
   
![](./Graphics/fileset.png)

## 03. Download .CSV File

Download csv file documenting all vehicle recalls in Cannada.

![](./Graphics/download.png)

## 04. ETL

## 05. Peculiarities
  -Encountered JSON parsing error when trying to fetch database

![](./Graphics/jsonerror.png)

  -After some sleuthing, pinpointed problem rows in database:
  
![](./Graphics/dbmystery.png)

  -The values looked strange, but nothing about them explained why JSON had read them as infinity. The csv files held some answers though...
  
![](./Graphics/csvsolution1.png)
![](./Graphics/csvsolution2.png)

  -A-ha! Some values in the original csv contained some codes in a number-'E'-number format, and upon reformatting they had been parsed as scientific notation.
  
  -Very few rows even contained values in the offending column, so the simplest solution seemed to be to drop the column entirely from our data. There didn't seem to be any pattern to Manufacturer's recall codes anyway.
  
  -Oracle was reacting badly to the offending data, so we eventually opted to drop the table entirely and rebuild it with a modified SQL statement.
  
![](./Graphics/recreatetable.png)
![](./Graphics/recreatetable2.png)

  -While we were at it we pulled out four columns that were french translations of other columns. None of us speak French.


## 06. Visualizations

-Creating dataframe from Oracle's database

```{r}
require("jsonlite")
require("RCurl")
dframe <- data.frame(fromJSON(getURL(URLencode('129.152.144.84:5001/rest/native/?query="select * from recalls"'),httpheader=c(DB='jdbc:oracle:thin:@129.152.144.84:1521/PDBF15DV.usuniversi01134.oraclecloud.internal', USER='cs329e_qan74', PASS='orcl_qan74', MODE='native_mode', MODEL='model', returnDimensions = 'False', returnFor = 'JSON'), verbose = TRUE), ))
```

### Summary

```{r}
summary(dframe)
```  

### Subset

-A subset of recalls where number of units affected is greater than 400,000:

```{r, warning = FALSE}
head(subset(dframe, as.numeric(as.character(UNIT_AFFECTED_NBR)) > 400000))
```

### Our Visualizations
